<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公文擬辦參考小幫手</title>
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 使用 Tailwind 預設的 Inter 字體 */
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
        }
        /* 保持 <pre> 標籤的換行和空格 */
        .option-text {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 0.95rem; /* 稍微調整字體大小 */
            line-height: 1.7;   /* 增加行高 */
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen p-4 md:p-8">

    <main class="max-w-4xl mx-auto bg-white rounded-xl shadow-2xl overflow-hidden">
        <header class="bg-slate-800 p-6">
            <h1 class="text-2xl md:text-3xl font-bold text-white text-center">公文擬辦參考小幫手</h1>
            <p class="text-center text-slate-300 mt-2">點擊類別展開選項，並可一鍵複製擬辦內容。</p>
        </header>

        <!-- 擬辦選項容器 -->
        <div id="accordion-container" class="p-4 md:p-6 space-y-4">
            <!-- 內容將由 JavaScript 動態生成 -->
        </div>
    </main>

    <script>
        // 1. 從 PDF 提取並結構化的資料 (已修正為全形標點)
        const draftData = [
            {
                category: "研習活動",
                options: [
                    "一、旨揭研習課程業經徵詢相關（領域）老師，均因公忙不克參加，無須辦理。\n二、陳閱後文存。",
                    "一、旨揭研習課程業經徵詢相關（領域）老師，擬請 ○○○ 師參加。\n二、擬請教務處、人事室，協助辦理薦派、課務派代及公假事宜。\n三、奉核後文存。",
                    "一、旨揭研習，業於本校網頁公布周知（如附件），並無人員報名，故無須辦理。\n二、陳閱後文存。",
                    "一、旨揭研習擬不派員參加。\n二、陳閱後文存。"
                ]
            },
            {
                category: "各項敘獎",
                options: [
                    "一、旨揭（競賽）活動，業已辦理完畢，建議敘獎名額如下：總務主任 ○○ 嘉獎 ○ 次，承辦人 ○○ 嘉獎 ○ 次。\n二、案奉核後，擬請人事室辦理後續敘獎事宜。\n三、文陳閱後存查。"
                ]
            },
            {
                category: "轉知比賽或活動訊息",
                options: [
                    "【需函報或免備文逕送參賽者資料時】\n一、旨揭（競賽）活動訊息，業於本校網頁公布周知，截至今日無人報名。\n二、文擬陳閱後存查。\n（有參賽者，請參考免備文逕送案件。）",
                    "【無需函報或免備文逕送參賽者資料時】\n一、旨揭（競賽）活動訊息，擬鼓勵學生（同仁）參加，並於本校網頁公布周知，若有人員報名，則另案辦理後續參（賽）加事宜。\n二、陳閱後文存。",
                    "一、旨揭（○○競賽）活動，業經徵詢專任老師，表示無該項專長學生，故不派員參加。\n二、陳閱後文存。",
                    "一、旨揭（○○○競賽）活動，擬不派員參加。\n二、陳閱後文存。"
                ]
            },
            {
                category: "轉知法令",
                options: [
                    "【案一】\n一、旨揭法令規定，經查現無應辦事項，擬錄案存參利用。\n二、陳閱後文存。",
                    "【案二】\n一、旨揭法令規定係屬轉知性質，經查本校無應辦事項。\n二、陳閱後文存。",
                    "【需會知其他處室】\n一、旨揭「○○」規定，擬陳核閱後，轉知各處室，爾後辦理○○相關業務時，應依該規定配合辦理。\n二、文存。"
                ]
            },
            {
                category: "限期案件 / 免備文逕送案件",
                options: [
                    "一、本案業依函示規定辦理如後附件，擬奉核後，免備文逕送 ○○○。\n二、陳閱後文存。",
                    "一、本案業依函示規定辦理如後附件，擬奉核後，附件原本擬免備文逕送教育局，電子檔存卷歸檔。\n二、陳閱後文存。",
                    "一、本案擬填報資料如後附件，擬奉核後，依函示規定上網填報。\n二、陳閱後文存。",
                    "一、本案擬不提出申請（無須辦理），依說明二規定，無須回復。\n二、陳閱後文存。",
                    "一、本校查無旨揭情形，依說明二規定，無須回復。\n二、陳閱後文存。"
                ]
            },
            {
                category: "書面資料僅 1 份原本時",
                options: [
                    "【紙本簽核時】\n請於抄本或影印本上加註：「原本隨文發出（或原本逕送○○○），抄本（或影印本）存卷歸檔」，並加蓋職章。",
                    "【線上簽核時】\n請於簽陳時，即要於簽文中敘明「奉核後，附件原本擬免備文逕送○○○，電子檔存卷歸檔」。",
                    "【附件不隨文歸檔】\n本案因附件數量龐大，且承辦相關業務須隨時參考，為環保節省紙張，擬由承辦人員抽存參辦，不隨文歸檔。"
                ]
            },
            {
                category: "副本 (無應辦事項)",
                options: [
                    "一、本案係屬副知性質，查無應辦事項。\n二、陳閱後文存。"
                ]
            },
            {
                category: "函報 (擬不辦理)",
                options: [
                    "一、查本校無旨揭 ○○ 事項，依說明規定免回復。\n二、陳閱後文存。",
                    "一、旨揭 ○○，本校擬不申請。\n二、陳閱後文存。",
                    "一、本案業於本校網頁（教師晨會）公布周知，截至今日無人提出申請，故擬不辦理 ○○。\n二、文擬陳閱後存查。"
                ]
            }
        ];

        // 2. 頁面載入後執行
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('accordion-container');
            if (!container) return;

            // 3. 根據資料動態生成 HTML
            draftData.forEach((item, index) => {
                // 創建手風琴項目
                const itemEl = document.createElement('div');
                itemEl.className = 'border border-slate-200 rounded-lg overflow-hidden';

                // 創建標題按鈕
                const headerEl = document.createElement('button');
                headerEl.className = 'accordion-header w-full flex justify-between items-center p-4 bg-slate-50 hover:bg-slate-200 transition-colors duration-200';
                headerEl.setAttribute('aria-expanded', 'false');
                headerEl.setAttribute('aria-controls', `panel-${index}`);
                
                headerEl.innerHTML = `
                    <span class="text-lg font-semibold text-slate-700">${index + 1}、${item.category}</span>
                    <!-- SVG 箭頭圖標 -->
                    <svg class="arrow-icon w-5 h-5 text-slate-500 transition-transform duration-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                    </svg>
                `;

                // 創建內容面板
                const panelEl = document.createElement('div');
                panelEl.id = `panel-${index}`;
                panelEl.className = 'accordion-panel hidden p-4 space-y-3';
                
                // 創建每個選項卡
                item.options.forEach(optionText => {
                    const cardEl = document.createElement('div');
                    cardEl.className = 'option-card bg-slate-50 border border-slate-200 rounded-lg p-4 shadow-sm';
                    
                    // 顯示擬辦文字 (使用 <pre> 保持格式)
                    const textEl = document.createElement('pre');
                    textEl.className = 'option-text text-slate-800 mb-4';
                    textEl.textContent = optionText;

                    // 複製按鈕
                    const copyBtn = document.createElement('button');
                    copyBtn.className = 'copy-btn bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50';
                    copyBtn.textContent = '複製內容';
                    // 將要複製的文字存在 data-copy 屬性中
                    copyBtn.dataset.copy = optionText;

                    cardEl.appendChild(textEl);
                    cardEl.appendChild(copyBtn);
                    panelEl.appendChild(cardEl);
                });

                itemEl.appendChild(headerEl);
                itemEl.appendChild(panelEl);
                container.appendChild(itemEl);
            });

            // 4. 設定事件監聽 (使用事件委派)
            container.addEventListener('click', (e) => {
                // 點擊手風琴標題
                const header = e.target.closest('.accordion-header');
                if (header) {
                    const panel = header.nextElementSibling;
                    const arrow = header.querySelector('.arrow-icon');
                    const isExpanded = header.getAttribute('aria-expanded') === 'true';

                    if (isExpanded) {
                        panel.classList.add('hidden');
                        header.setAttribute('aria-expanded', 'false');
                        arrow.classList.remove('rotate-180');
                    } else {
                        panel.classList.remove('hidden');
                        header.setAttribute('aria-expanded', 'true');
                        arrow.classList.add('rotate-180');
                    }
                }

                // 點擊複製按鈕
                const copyButton = e.target.closest('.copy-btn');
                if (copyButton) {
                    const textToCopy = copyButton.dataset.copy;
                    copyToClipboard(textToCopy, copyButton);
                }
            });
        });

        // 5. 複製到剪貼簿的功能
        function copyToClipboard(text, buttonEl) {
            // 使用 document.execCommand 作為備用方案，因 navigator.clipboard 在某些環境 (如 iframe) 可能受限
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed'; // 移出畫面
            textarea.style.opacity = 0;
            document.body.appendChild(textarea);
            textarea.select();
            
            try {
                document.execCommand('copy');
                // 提供視覺反饋
                buttonEl.textContent = '已複製！';
                buttonEl.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                buttonEl.classList.add('bg-green-600');

                // 2 秒後恢復原狀
                setTimeout(() => {
                    buttonEl.textContent = '複製內容';
                    buttonEl.classList.remove('bg-green-600');
                    buttonEl.classList.add('bg-blue-600', 'hover:bg-blue-700');
                }, 2000);

            } catch (err) {
                console.error('複製失敗:', err);
                buttonEl.textContent = '複製失敗';
                buttonEl.classList.add('bg-red-600');
            }
            
            document.body.removeChild(textarea);
        }

    </script>
</body>
</html>


